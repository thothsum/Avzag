{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.flat.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./node_modules/core-js/modules/es.array.unscopables.flat.js","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/Phrasebook/Block/Display.vue?ab10","webpack:///./src/Phrasebook/Context/index.vue","webpack:///./src/Phrasebook/Context/index.vue?ec8a","webpack:///./src/Phrasebook/Context/index.vue?3f4e","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./src/Phrasebook/Context/index.vue?1c7d","webpack:///./src/Phrasebook/Block/index.vue?9ea6","webpack:///./src/Phrasebook/Block/IndexedColor.vue?3468","webpack:///./src/Phrasebook/Block/index.vue","webpack:///./src/Phrasebook/Block/IndexedColor.vue","webpack:///./src/Phrasebook/Block/IndexedColor.vue?82f8","webpack:///./src/Phrasebook/Block/IndexedColor.vue?6005","webpack:///./src/Phrasebook/Block/condition.ts","webpack:///./src/Phrasebook/Block/index.vue?471d","webpack:///./src/Phrasebook/Block/index.vue?892b","webpack:///./src/Phrasebook/Block/Display.vue","webpack:///./src/Phrasebook/Block/Display.vue?c5a3","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/internals/flatten-into-array.js","webpack:///./node_modules/core-js/modules/es.number.constructor.js","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js"],"names":["$","flattenIntoArray","toObject","toLength","toInteger","arraySpeciesCreate","target","proto","flat","depthArg","arguments","length","undefined","O","this","sourceLen","A","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","Object","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","addToUnscopables","$some","some","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","forced","callbackfn","class","any","tags","ts","i","t","key","props","translation","type","default","blocks","setup","context","dictionary","entities","forEach","entity","reduce","d","explicitContext","filter","b","visible","map","requirements","conditions","all","concat","c","tag","Set","add","translate","k","entries","value","e","has","render","__scopeId","module","exports","requireObjectCoercible","whitespaces","whitespace","ltrim","RegExp","rtrim","createMethod","TYPE","$this","string","String","replace","start","end","trim","state","disabled","glossed","move","indexes","activeIndexes","ref","colored","classes","passive","name","Boolean","getEntityIndexes","set","indexOf","checkConditions","f","findBestState","states","fit","len","candidates","s","l","applyConditions","positive","delete","components","IndexedColor","Display","block","emits","transition","display","switchState","nextState","nextVisible","immediate","deep","keys","passiveIndexes","_conditions","split","Number","types","implicit","segments","j","colors","inject","computed","text","texts","join","fails","isObject","createProperty","arrayMethodHasSpeciesSupport","wellKnownSymbol","V8_VERSION","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","IS_CONCAT_SPREADABLE_SUPPORT","array","SPECIES_SUPPORT","isConcatSpreadable","spreadable","FORCED","arg","E","n","IndexedObject","toIndexedObject","nativeJoin","ES3_STRINGS","separator","call","bind","original","source","depth","mapper","thisArg","element","targetIndex","sourceIndex","mapFn","DESCRIPTORS","global","isForced","redefine","classof","inheritIfRequired","toPrimitive","create","getOwnPropertyNames","getOwnPropertyDescriptor","defineProperty","NUMBER","NativeNumber","NumberPrototype","prototype","BROKEN_CLASSOF","toNumber","argument","first","third","radix","maxCode","digits","index","code","it","charCodeAt","NaN","slice","parseInt","NumberWrapper","dummy","valueOf","constructor","nativeKeys","FAILS_ON_PRIMITIVES","stat","$indexOf","nativeIndexOf","NEGATIVE_ZERO","ACCESSORS","1","searchElement","apply"],"mappings":"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","file":"js/chunk-b61ff0ca.99344673.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = toLength(O.length);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toInteger(depthArg));\n    return A;\n  }\n});\n","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.es/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Display.vue?vue&type=style&index=0&id=091515ec&lang=scss&scoped=true\"","<template>\n  <div class=\"row text-caption wrap\">\n    <div class=\"icon\">info</div>\n    <template v-if=\"any\">\n      <template v-for=\"(ts, i) of tags\" :key=\"i\">\n        <div v-if=\"ts.length\" class=\"row-0 wrap\">\n          <p\n            v-for=\"t in ts\"\n            :key=\"t\"\n            class=\"text-dot\"\n            :class=\"'colored-dot-' + i\"\n          >\n            {{ t }}\n          </p>\n        </div>\n      </template></template\n    >\n    <p v-else>â€¦</p>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, Condition, BlockVue } from \"../types\";\n\nexport default defineComponent({\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation[]>,\n      default: () => [],\n    },\n    blocks: { type: Array as PropType<BlockVue[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const dictionary = computed(() => {\n      const translation = {\n        entities: {} as Record<string, string>,\n        tags: {} as Record<string, Record<string, string>>,\n      };\n      if (props.translation)\n        props.translation.forEach(({ entity, tags }) => {\n          translation.entities[entity[0]] = entity[1];\n          translation.tags[entity[0]] = (tags ?? []).reduce((d, t) => {\n            d[t[0]] = t[1];\n            return d;\n          }, {} as Record<string, string>);\n        });\n      return translation;\n    });\n\n    const explicitContext = computed(\n      () =>\n        props.blocks\n          ?.filter((b) => b?.visible)\n          .map(({ requirements, conditions }) => {\n            let all = [] as Condition[];\n            if (requirements) all = all.concat(requirements);\n            if (conditions) all = all.concat(conditions);\n            return all;\n          })\n          .flat()\n          .reduce((c, { entity, tag }) => {\n            if (!c[entity]) c[entity] = new Set();\n            if (tag) c[entity].add(tag);\n            return c;\n          }, {} as Context) ?? {}\n    );\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      if (d) {\n        const t = d[k];\n        if (t) return t;\n      }\n      return k;\n    }\n    const tags = computed(() =>\n      Object.entries(context.value).map(([e, ts]) =>\n        [...(ts ?? [])]\n          .filter((t) => !explicitContext.value[e]?.has(t))\n          .map((t) => translate(dictionary.value.tags[e], t))\n      )\n    );\n    const any = computed(() => tags.value.some((t) => t?.length));\n\n    return { tags, any, explicitContext };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.icon {\n  font-size: map-get($font-sizes, \"small\");\n}\n</style>\n","\nimport { computed, defineComponent, inject, Ref, PropType } from \"vue\";\nimport { Context, ContextTranslation, Condition, BlockVue } from \"../types\";\n\nexport default defineComponent({\n  props: {\n    translation: {\n      type: Object as PropType<ContextTranslation[]>,\n      default: () => [],\n    },\n    blocks: { type: Array as PropType<BlockVue[]>, default: () => [] },\n  },\n  setup(props) {\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    const dictionary = computed(() => {\n      const translation = {\n        entities: {} as Record<string, string>,\n        tags: {} as Record<string, Record<string, string>>,\n      };\n      if (props.translation)\n        props.translation.forEach(({ entity, tags }) => {\n          translation.entities[entity[0]] = entity[1];\n          translation.tags[entity[0]] = (tags ?? []).reduce((d, t) => {\n            d[t[0]] = t[1];\n            return d;\n          }, {} as Record<string, string>);\n        });\n      return translation;\n    });\n\n    const explicitContext = computed(\n      () =>\n        props.blocks\n          ?.filter((b) => b?.visible)\n          .map(({ requirements, conditions }) => {\n            let all = [] as Condition[];\n            if (requirements) all = all.concat(requirements);\n            if (conditions) all = all.concat(conditions);\n            return all;\n          })\n          .flat()\n          .reduce((c, { entity, tag }) => {\n            if (!c[entity]) c[entity] = new Set();\n            if (tag) c[entity].add(tag);\n            return c;\n          }, {} as Context) ?? {}\n    );\n\n    function translate(d: undefined | Record<string, string>, k: string) {\n      if (d) {\n        const t = d[k];\n        if (t) return t;\n      }\n      return k;\n    }\n    const tags = computed(() =>\n      Object.entries(context.value).map(([e, ts]) =>\n        [...(ts ?? [])]\n          .filter((t) => !explicitContext.value[e]?.has(t))\n          .map((t) => translate(dictionary.value.tags[e], t))\n      )\n    );\n    const any = computed(() => tags.value.some((t) => t?.length));\n\n    return { tags, any, explicitContext };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=290f6ec3&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=290f6ec3&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-290f6ec3\"\n\nexport default script","// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=290f6ec3&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=6eac1f64&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./IndexedColor.vue?vue&type=style&index=0&id=3005f8b7&lang=scss&scoped=true\"","<template>\n  <button\n    v-show=\"visible\"\n    v-if=\"state\"\n    class=\"small\"\n    :class=\"{ disabled, glossed }\"\n    @click=\"move\"\n  >\n    <!-- <IndexedColor :passive=\"true\" :indexes=\"passiveIndexes\" /> -->\n    <IndexedColor :indexes=\"activeIndexes\" />\n    <Display\n      ref=\"display\"\n      :glossed=\"glossed\"\n      :colored=\"true\"\n      :state=\"state\"\n      :context=\"context\"\n    />\n  </button>\n</template>\n\n<script lang=\"ts\">\nimport IndexedColor from \"./IndexedColor.vue\";\nimport Display from \"./Display.vue\";\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, Block, State, Condition } from \"../types\";\nimport {\n  applyConditions,\n  findBestState,\n  checkConditions,\n  getEntityIndexes,\n} from \"./condition\";\n\nexport default defineComponent({\n  components: { IndexedColor, Display },\n  props: {\n    block: { type: Object as PropType<Block>, default: () => ({}) },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const requirements = computed(() => props.block.requirements);\n    const conditions = computed(() => state.value?.conditions);\n    const transition = computed(() => state.value?.transition);\n    const disabled = computed(() => !transition.value);\n    const visible = ref(false);\n    const display = ref();\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      applyConditions(state.value?.conditions, context, false);\n      applyConditions(nextState?.conditions, context, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextVisible =\n          context && checkConditions(requirements.value, context)[0] === 1;\n\n        if (nextVisible) {\n          const nextState = findBestState(\n            undefined,\n            props.block.states,\n            context\n          );\n          if (toRaw(nextState) !== toRaw(state.value)) switchState(nextState);\n        } else if (state.value) switchState(undefined);\n\n        visible.value = nextVisible;\n      },\n      { immediate: true, deep: true }\n    );\n\n    const entities = computed(() => Object.keys(context.value));\n    const passiveIndexes = computed(() => {\n      let _conditions: Condition[] = [];\n\n      if (requirements.value)\n        _conditions = _conditions.concat(requirements.value);\n      if (conditions.value) {\n        _conditions = _conditions.concat(\n          transition.value\n            ? conditions.value.filter((c) => c.passive)\n            : conditions.value\n        );\n      }\n\n      return getEntityIndexes(_conditions, entities.value);\n    });\n    const activeIndexes = computed(() => {\n      return transition.value && conditions.value\n        ? getEntityIndexes(\n            conditions.value.filter(({ passive }) => !passive),\n            entities.value\n          )\n        : [];\n    });\n\n    function move() {\n      if (disabled.value) return;\n      const states = props.block.states;\n      if (typeof transition.value === \"string\") {\n        let nextState;\n        if (transition.value === \"next\") {\n          const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n          nextState = states[(i + 1) % states.length];\n        } else if (transition.value) {\n          const i = transition.value.split(\" \").map((i) => Number(i));\n          nextState = findBestState(i, states, context.value);\n        }\n        switchState(nextState);\n      } else if (transition.value) {\n        // directly modify global environment\n      }\n    }\n\n    return {\n      passiveIndexes,\n      activeIndexes,\n      move,\n      context,\n      state,\n      visible,\n      disabled,\n      display,\n      conditions,\n      requirements,\n    };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\nbutton {\n  position: relative;\n  &.glossed {\n    height: map-get($button-height, \"normal\") + map-get($margins, \"normal\");\n  }\n}\n.disabled {\n  padding: 0;\n  background-color: transparent;\n  &:hover,\n  &:active {\n    background-color: transparent;\n  }\n  cursor: default;\n}\n</style>\n","<template>\n  <div v-if=\"classes\" class=\"row line\" :class=\"{ passive }\">\n    <p v-for=\"(c, i) in classes\" :key=\"i\" class=\"dash\" :class=\"c\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, PropType } from \"vue\";\n\nexport default defineComponent({\n  name: \"IndexedColor\",\n  props: {\n    indexes: { type: Array as PropType<number[]>, default: () => [] },\n    passive: Boolean,\n  },\n  setup(props) {\n    const classes = computed(() =>\n      props.indexes.map((i) => \"colored-back-\" + i)\n    );\n    return { classes };\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.line {\n  overflow: hidden;\n  border-radius: 0 0 $border-radius $border-radius;\n  height: $border-radius;\n  width: 100%;\n  left: 0;\n  justify-content: center;\n  position: absolute;\n  .dash {\n    height: 100%;\n    width: 4 * $border-radius;\n  }\n  &.passive {\n    top: 0;\n  }\n  &:not(.passive) {\n    bottom: 0;\n  }\n}\n</style>\n","\nimport { computed, defineComponent, PropType } from \"vue\";\n\nexport default defineComponent({\n  name: \"IndexedColor\",\n  props: {\n    indexes: { type: Array as PropType<number[]>, default: () => [] },\n    passive: Boolean,\n  },\n  setup(props) {\n    const classes = computed(() =>\n      props.indexes.map((i) => \"colored-back-\" + i)\n    );\n    return { classes };\n  },\n});\n","import { render } from \"./IndexedColor.vue?vue&type=template&id=3005f8b7&scoped=true\"\nimport script from \"./IndexedColor.vue?vue&type=script&lang=ts\"\nexport * from \"./IndexedColor.vue?vue&type=script&lang=ts\"\n\nimport \"./IndexedColor.vue?vue&type=style&index=0&id=3005f8b7&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-3005f8b7\"\n\nexport default script","import { Ref } from \"vue\";\nimport { Condition, Context, State } from \"../types\";\n\nexport function getEntityIndexes(conditions: Condition[], entities: string[]) {\n  const set = new Set(conditions.map((c) => c.entity));\n  return [...set].map((e) => entities.indexOf(e));\n}\n\nexport function checkConditions(\n  conditions: undefined | Condition[],\n  context: Context\n): [number, number] {\n  return conditions?.length\n    ? [\n        conditions.reduce((f, { entity, tag }) => {\n          return f + (tag ? (context[entity]?.has(tag) ? 1 : 0) : 1);\n        }, 0) / conditions.length,\n        conditions.length,\n      ]\n    : [1, 0];\n}\n\nexport function findBestState(\n  indexes: undefined | number[],\n  states: State[],\n  context: Context\n) {\n  let state = null;\n  let fit = 0;\n  let len = 0;\n\n  const candidates = indexes?.map((i) => states[i]) ?? states ?? [];\n  candidates.forEach((s) => {\n    if (!s.conditions) return;\n    const [f, l] = checkConditions(s.conditions, context);\n    if (fit === 1 ? f === 1 && l >= len : f >= fit) {\n      state = s;\n      fit = f;\n      len = l;\n    }\n  });\n\n  return state ?? candidates[0];\n}\n\nexport function applyConditions(\n  conditions: undefined | Condition[],\n  context: Ref<Context>,\n  positive: boolean\n) {\n  if (!conditions) return;\n  conditions.forEach(({ entity, tag, passive }) => {\n    const set = context.value[entity];\n    if (passive || !tag || !set) return;\n    if (positive) set.add(tag);\n    else set.delete(tag);\n  });\n}\n","\nimport IndexedColor from \"./IndexedColor.vue\";\nimport Display from \"./Display.vue\";\nimport {\n  computed,\n  defineComponent,\n  inject,\n  PropType,\n  ref,\n  Ref,\n  toRaw,\n  watch,\n} from \"vue\";\nimport { Context, Block, State, Condition } from \"../types\";\nimport {\n  applyConditions,\n  findBestState,\n  checkConditions,\n  getEntityIndexes,\n} from \"./condition\";\n\nexport default defineComponent({\n  components: { IndexedColor, Display },\n  props: {\n    block: { type: Object as PropType<Block>, default: () => ({}) },\n    glossed: Boolean,\n  },\n  emits: [\"update:modelValue\"],\n  setup(props) {\n    const state = ref<State>();\n    const requirements = computed(() => props.block.requirements);\n    const conditions = computed(() => state.value?.conditions);\n    const transition = computed(() => state.value?.transition);\n    const disabled = computed(() => !transition.value);\n    const visible = ref(false);\n    const display = ref();\n\n    const context = inject(\"context\", {} as Ref<Context>);\n\n    function switchState(nextState: undefined | State) {\n      applyConditions(state.value?.conditions, context, false);\n      applyConditions(nextState?.conditions, context, true);\n      state.value = nextState;\n    }\n    watch(\n      context,\n      (context) => {\n        const nextVisible =\n          context && checkConditions(requirements.value, context)[0] === 1;\n\n        if (nextVisible) {\n          const nextState = findBestState(\n            undefined,\n            props.block.states,\n            context\n          );\n          if (toRaw(nextState) !== toRaw(state.value)) switchState(nextState);\n        } else if (state.value) switchState(undefined);\n\n        visible.value = nextVisible;\n      },\n      { immediate: true, deep: true }\n    );\n\n    const entities = computed(() => Object.keys(context.value));\n    const passiveIndexes = computed(() => {\n      let _conditions: Condition[] = [];\n\n      if (requirements.value)\n        _conditions = _conditions.concat(requirements.value);\n      if (conditions.value) {\n        _conditions = _conditions.concat(\n          transition.value\n            ? conditions.value.filter((c) => c.passive)\n            : conditions.value\n        );\n      }\n\n      return getEntityIndexes(_conditions, entities.value);\n    });\n    const activeIndexes = computed(() => {\n      return transition.value && conditions.value\n        ? getEntityIndexes(\n            conditions.value.filter(({ passive }) => !passive),\n            entities.value\n          )\n        : [];\n    });\n\n    function move() {\n      if (disabled.value) return;\n      const states = props.block.states;\n      if (typeof transition.value === \"string\") {\n        let nextState;\n        if (transition.value === \"next\") {\n          const i = state.value ? states.indexOf(toRaw(state.value)) : -1;\n          nextState = states[(i + 1) % states.length];\n        } else if (transition.value) {\n          const i = transition.value.split(\" \").map((i) => Number(i));\n          nextState = findBestState(i, states, context.value);\n        }\n        switchState(nextState);\n      } else if (transition.value) {\n        // directly modify global environment\n      }\n    }\n\n    return {\n      passiveIndexes,\n      activeIndexes,\n      move,\n      context,\n      state,\n      visible,\n      disabled,\n      display,\n      conditions,\n      requirements,\n    };\n  },\n});\n","import { render } from \"./index.vue?vue&type=template&id=6eac1f64&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=6eac1f64&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-6eac1f64\"\n\nexport default script","<template>\n  <div>\n    <p\n      v-for=\"(t, i) in types\"\n      :key=\"i\"\n      :class=\"{ 'text-faded': state.implicit, 'text-ipa': t == 'ipa', t }\"\n    >\n      <span v-for=\"(s, j) in segments[i]\" :key=\"j\" :class=\"colors[j]\">\n        {{ s }}\n      </span>\n    </p>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"PhraseStateDisplay\",\n  inject: [\"context\"],\n  props: {\n    state: { type: Object },\n    glossed: { type: Boolean, default: false },\n    colored: { type: Boolean, default: true },\n  },\n  computed: {\n    entities() {\n      return Object.keys(this.context.value);\n    },\n    types() {\n      return this.glossed ? [\"ipa\", \"glossing\"] : [\"text\"];\n    },\n    colors() {\n      return this.colored\n        ? this.state.display.map(\n            (d) => \"colored-\" + this.entities.indexOf(d.entity)\n          )\n        : [];\n    },\n    segments() {\n      return this.types.map((t) => this.state.display.map((d) => d[t]));\n    },\n    text() {\n      const texts = this.segments.map((s) => s.join(\"\"));\n      return texts.length === 1 ? texts[0] : texts.join(\"\\n\");\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\np {\n  display: flex;\n  gap: 0;\n}\n</style>\n","import { render } from \"./Display.vue?vue&type=template&id=091515ec&scoped=true\"\nimport script from \"./Display.vue?vue&type=script&lang=js\"\nexport * from \"./Display.vue?vue&type=script&lang=js\"\n\nimport \"./Display.vue?vue&type=style&index=0&id=091515ec&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-091515ec\"\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.es/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg, 3) : false;\n  var element;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar has = require('../internals/has');\nvar classof = require('../internals/classof-raw');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar create = require('../internals/object-create');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\n\n// Opera ~12 has broken Object#toString\nvar BROKEN_CLASSOF = classof(create(NumberPrototype)) == NUMBER;\n\n// `ToNumber` abstract operation\n// https://tc39.es/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = it.charCodeAt(0);\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = it.slice(2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = digits.charCodeAt(index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.es/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var dummy = this;\n    return dummy instanceof NumberWrapper\n      // check on 1..constructor(foo) case\n      && (BROKEN_CLASSOF ? fails(function () { NumberPrototype.valueOf.call(dummy); }) : classof(dummy) != NUMBER)\n        ? inheritIfRequired(new NativeNumber(toNumber(it)), dummy, NumberWrapper) : toNumber(it);\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,' +\n    // ESNext\n    'fromString,range'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(NativeNumber, key = keys[j]) && !has(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.es/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}